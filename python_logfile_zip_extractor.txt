import pandas as pd
from google.colab import drive
drive.mount('/content/drive')

from zipfile import ZipFile
all_files = ZipFile('/content/drive/MyDrive/HTWebLog_p1.zip','r')

file_names = all_files.namelist()

file_counts = 0

for name in file_names: 
  if name.endswith('.log'):
     file_counts += 1

print(file_counts)

ColumnNames=['date','time','s-sitename','s-ip','cs-method','cs-uri-stem','cs-uri-query','s-port','cs-username',
             'c-ip','cs(User-Agent)','cs(Referer)','sc-status','sc-substatus','sc-win32-status']

def query_zip(name_of_file):
  zip_data = pd.read_csv(all_files.open(name_of_file), encoding = 'latin1', comment = '#', sep = " ", names = ColumnNames)
  return zip_data

all_data = [query_zip(name) for name in file_names]
df_ht = pd.concat(all_data)
df_ht.head()